2018-02-24 20:27:15.300597: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2018-02-24 20:27:15.300870: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2018-02-24 20:27:15.300883: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
Using TensorFlow backend.
2018-02-24 20:27:11.704594 Start.
Training mixture of experts with adaptive threshold on BirdVox-70k with PCEN input. 
Training set: unit07, unit10, unit01.
Validation set: unit02, unit03.
Test set: unit05.

h5py version: 2.6.0
keras version: 2.0.6
numpy version: 1.13.1
pandas version: 0.20.3
pescador version: 1.0.0
tensorflow version: 1.2.1

____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to                     
====================================================================================================
spec_input (InputLayer)          (None, 128, 104, 1)   0                                            
____________________________________________________________________________________________________
spec_bn (BatchNormalization)     (None, 128, 104, 1)   4           spec_input[0][0]                 
____________________________________________________________________________________________________
spec_conv1 (Conv2D)              (None, 128, 104, 24)  624         spec_bn[0][0]                    
____________________________________________________________________________________________________
bg_input (InputLayer)            (None, 128, 9)        0                                            
____________________________________________________________________________________________________
spec_pool1 (MaxPooling2D)        (None, 64, 26, 24)    0           spec_conv1[0][0]                 
____________________________________________________________________________________________________
bg_pool (AveragePooling1D)       (None, 32, 9)         0           bg_input[0][0]                   
____________________________________________________________________________________________________
spec_conv2 (Conv2D)              (None, 64, 26, 48)    28848       spec_pool1[0][0]                 
____________________________________________________________________________________________________
bg_permute (Permute)             (None, 9, 32)         0           bg_pool[0][0]                    
____________________________________________________________________________________________________
spec_pool2 (MaxPooling2D)        (None, 32, 6, 48)     0           spec_conv2[0][0]                 
____________________________________________________________________________________________________
bg_conv (Conv1D)                 (None, 9, 8)          264         bg_permute[0][0]                 
____________________________________________________________________________________________________
spec_conv3 (Conv2D)              (None, 32, 6, 48)     57648       spec_pool2[0][0]                 
____________________________________________________________________________________________________
bg_flatten (Flatten)             (None, 72)            0           bg_conv[0][0]                    
____________________________________________________________________________________________________
spec_flatten (Flatten)           (None, 9216)          0           spec_conv3[0][0]                 
____________________________________________________________________________________________________
bg_dense1 (Dense)                (None, 64)            4672        bg_flatten[0][0]                 
____________________________________________________________________________________________________
spec_dense (Dense)               (None, 64)            589888      spec_flatten[0][0]               
____________________________________________________________________________________________________
bg_experts (Dense)               (None, 4)             260         bg_dense1[0][0]                  
____________________________________________________________________________________________________
spec_reshape (Reshape)           (None, 16, 4)         0           spec_dense[0][0]                 
____________________________________________________________________________________________________
bg_reshape (Reshape)             (None, 1, 4)          0           bg_experts[0][0]                 
____________________________________________________________________________________________________
multiply (Multiply)              (None, 16, 4)         0           spec_reshape[0][0]               
                                                                   bg_reshape[0][0]                 
____________________________________________________________________________________________________
mixture_of_experts (Flatten)     (None, 64)            0           multiply[0][0]                   
____________________________________________________________________________________________________
adaptive_threshold (Dense)       (None, 1)             64          bg_dense1[0][0]                  
____________________________________________________________________________________________________
concatenate (Concatenate)        (None, 65)            0           mixture_of_experts[0][0]         
                                                                   adaptive_threshold[0][0]         
____________________________________________________________________________________________________
dense (Dense)                    (None, 1)             66          concatenate[0][0]                
====================================================================================================
Total params: 682,338
Trainable params: 682,336
Non-trainable params: 2
____________________________________________________________________________________________________
         acc      loss   val_acc  val_loss
0   0.960938  0.143236  0.928101  0.329434
1   0.955200  0.174079  0.945068  0.213884
2   0.957153  0.167861  0.906006  0.363052
3   0.967651  0.136049  0.919678  0.379125
4   0.967407  0.140420  0.915039  0.458018
5   0.971069  0.125803  0.951172  0.206690
6   0.974243  0.109323  0.936157  0.382286
7   0.977905  0.102725  0.926514  0.396916
8   0.977051  0.108218  0.931030  0.370663
9   0.980957  0.107665  0.909424  0.620893
10  0.979980  0.112235  0.931030  0.523665
11  0.939087  0.260371  0.896362  0.376521
12  0.917969  0.288701  0.924072  0.351118
13  0.924683  0.253269  0.905762  0.363482
14  0.945557  0.207516  0.915527  0.587859
15  0.958008  0.167237  0.939453  0.461990
16  0.966309  0.164499  0.916138  0.637116
17  0.906372  0.307257  0.908447  0.567269
18  0.917358  0.265129  0.874390  0.406603
19  0.912109  0.279210  0.897339  0.375726
20  0.921631  0.250833  0.938110  0.276752
21  0.931152  0.230717  0.913086  0.492295
22  0.934082  0.219220  0.825928  0.754709
23  0.930542  0.231583  0.900757  0.532125
24  0.511597  7.755850  0.506958  7.899207
25  0.497925  8.039391  0.502930  7.956193
26  0.504761  7.924240  0.503296  7.945042
27  0.510864  7.822223  0.494751  8.077082
28  0.767456  2.590076  0.835205  0.540113
29  0.824219  1.488006  0.496826  8.167000
30  0.502441  8.070790  0.499756  8.109740
31  0.490479  8.256303  0.494507  8.188781
32  0.496338  8.157247  0.489014  8.273458
33  0.497192  8.140098  0.507202  7.977326
34  0.505127  8.009532  0.497314  8.134276
35  0.505249  8.005340  0.495605  8.159774
36  0.508545  7.950312  0.508179  7.955343
37  0.506348  7.984057  0.502197  8.050179
38  0.491455  8.222605  0.500732  8.072371
39  0.509766  7.926116  0.491333  8.222570
40  0.492188  8.208187  0.501221  8.061987
41  0.502075  8.047640  0.508179  7.948694
42  0.494019  8.176383  0.500732  8.067626
43  0.489380  8.250084  0.492188  8.204311
44  0.496094  8.140848  0.492676  8.195439
45  0.507568  7.954916  0.509766  7.919019
46  0.506226  7.975614  0.489868  8.238804
47  0.499023  8.090794  0.500854  8.060841
48  0.497803  8.109606  0.496704  8.126895
49  0.496338  8.132397  0.499756  8.076909
50  0.504639  7.997830  0.510376  7.904983
51  0.500854  8.058098  0.491455  8.209251
52  0.499756  8.075129  0.495972  8.135799
53  0.491211  8.212229  0.489624  8.237508
54  0.514526  7.835849  0.487427  8.272369
55  0.493286  8.177669  0.502319  8.031819
56  0.508911  7.925336  0.487427  8.271393
57  0.499023  8.084260  0.500977  8.052569
58  0.499878  8.070078  0.498535  8.091527
59  0.505249  7.983129  0.500610  8.057717
60  0.500122  8.065417  0.498413  8.092795
61  0.505615  7.976551  0.501709  8.039355
62  0.504028  8.001821  0.505737  7.974125
63  0.495117  8.145155  0.493408  8.172556

2018-02-25 04:06:07.975786 Finish.
Total elapsed time: 07:38:56.98.
